(* Generated by coq-of-rust *)
Require Import CoqOfRust.CoqOfRust.

(*
fn age() -> u32 {
    15
}
*)
Definition age : M u32.t := ltac:(M.monadic ( (Integer.of_Z 15) : u32.t )).

(*
fn main() {
    println!("Tell me what type of person you are");

    match age() {
        0 => println!("I haven't celebrated my first birthday yet"),
        // Could `match` 1 ..= 12 directly but then what age
        // would the child be? Instead, bind to `n` for the
        // sequence of 1 ..= 12. Now the age can be reported.
        n @ 1..=12 => println!("I'm a child of age {:?}", n),
        n @ 13..=19 => println!("I'm a teen of age {:?}", n),
        // Nothing bound. Return the result.
        n => println!("I'm an old person of age {:?}", n),
    }
}
*)
(* #[allow(dead_code)] - function was ignored by the compiler *)
Definition main : M unit :=
  ltac:(M.monadic (
    M.read (|
      let _ : M.Val unit :=
        let _ : M.Val unit :=
          M.alloc (|
            M.call (|(std.io.stdio._print
              (M.call (|(core.fmt.Arguments.t::["new_const"]
                (pointer_coercion
                  "Unsize"
                  (borrow
                    (M.alloc (|
                      [
                        M.read (| mk_str "Tell me what type of person you are
"
                        |)
                      ]
                    |)))))
              |)))
            |)
          |) in
        M.alloc (| tt |) in
      ltac:
        (M.monadic_match_operator
          (M.alloc (| M.call (|match_binding.age |) |))
          [
            fun (γ : M.Val u32.t) =>
              (let _ : M.Val unit :=
                M.alloc (|
                  M.call (|(std.io.stdio._print
                    (M.call (|(core.fmt.Arguments.t::["new_const"]
                      (pointer_coercion
                        "Unsize"
                        (borrow
                          (M.alloc (|
                            [
                              M.read (|
                                mk_str
                                  "I haven't celebrated my first birthday yet
"
                              |)
                            ]
                          |)))))
                    |)))
                  |)
                |) in
              M.alloc (| tt |)) :
              M.Val unit;
            fun (γ : M.Val u32.t) =>
              (let n := M.copy (| γ |) in
              let _ : M.Val unit :=
                M.alloc (|
                  M.call (|(std.io.stdio._print
                    (M.call (|(core.fmt.Arguments.t::["new_v1"]
                      (pointer_coercion
                        "Unsize"
                        (borrow
                          (M.alloc (|
                            [
                              M.read (| mk_str "I'm a child of age " |);
                              M.read (| mk_str "
" |)
                            ]
                          |))))
                      (pointer_coercion
                        "Unsize"
                        (borrow
                          (M.alloc (|
                            [
                              M.call (|(core.fmt.rt.Argument.t::["new_debug"]
                                (borrow n))
                              |)
                            ]
                          |)))))
                    |)))
                  |)
                |) in
              M.alloc (| tt |)) :
              M.Val unit;
            fun (γ : M.Val u32.t) =>
              (let n := M.copy (| γ |) in
              let _ : M.Val unit :=
                M.alloc (|
                  M.call (|(std.io.stdio._print
                    (M.call (|(core.fmt.Arguments.t::["new_v1"]
                      (pointer_coercion
                        "Unsize"
                        (borrow
                          (M.alloc (|
                            [
                              M.read (| mk_str "I'm a teen of age " |);
                              M.read (| mk_str "
" |)
                            ]
                          |))))
                      (pointer_coercion
                        "Unsize"
                        (borrow
                          (M.alloc (|
                            [
                              M.call (|(core.fmt.rt.Argument.t::["new_debug"]
                                (borrow n))
                              |)
                            ]
                          |)))))
                    |)))
                  |)
                |) in
              M.alloc (| tt |)) :
              M.Val unit;
            fun (γ : M.Val u32.t) =>
              (let n := M.copy (| γ |) in
              let _ : M.Val unit :=
                M.alloc (|
                  M.call (|(std.io.stdio._print
                    (M.call (|(core.fmt.Arguments.t::["new_v1"]
                      (pointer_coercion
                        "Unsize"
                        (borrow
                          (M.alloc (|
                            [
                              M.read (| mk_str "I'm an old person of age " |);
                              M.read (| mk_str "
" |)
                            ]
                          |))))
                      (pointer_coercion
                        "Unsize"
                        (borrow
                          (M.alloc (|
                            [
                              M.call (|(core.fmt.rt.Argument.t::["new_debug"]
                                (borrow n))
                              |)
                            ]
                          |)))))
                    |)))
                  |)
                |) in
              M.alloc (| tt |)) :
              M.Val unit
          ])
    |)
  )).
