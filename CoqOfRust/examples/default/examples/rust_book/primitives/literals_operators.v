(* Generated by coq-of-rust *)
Require Import CoqOfRust.CoqOfRust.

(*
fn main() {
    // Integer addition
    println!("1 + 2 = {}", 1u32 + 2);

    // Integer subtraction
    println!("1 - 2 = {}", 1i32 - 2);
    // TODO ^ Try changing `1i32` to `1u32` to see why the type is important

    // Short-circuiting boolean logic
    println!("true AND false is {}", true && false);
    println!("true OR false is {}", true || false);
    println!("NOT true is {}", !true);

    // Bitwise operations
    println!("0011 AND 0101 is {:04b}", 0b0011u32 & 0b0101);
    println!("0011 OR 0101 is {:04b}", 0b0011u32 | 0b0101);
    println!("0011 XOR 0101 is {:04b}", 0b0011u32 ^ 0b0101);
    println!("1 << 5 is {}", 1u32 << 5);
    println!("0x80 >> 2 is 0x{:x}", 0x80u32 >> 2);

    // Use underscores to improve readability!
    println!("One million is written as {}", 1_000_000u32);
}
*)
Definition main (τ : list Ty.t) (α : list Value.t) : M :=
  match τ, α with
  | [], [] =>
    ltac:(M.monadic
      (M.read
        (|
          (let _ :=
            let _ :=
              M.alloc
                (|
                  (M.call_closure
                    (|
                      (M.get_function (| "std::io::stdio::_print", [] |)),
                      [
                        M.call_closure
                          (|
                            (M.get_associated_function
                              (| (Ty.path "core::fmt::Arguments"), "new_v1", []
                              |)),
                            [
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.read (| (mk_str "1 + 2 = ") |);
                                          M.read (| (mk_str "
") |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.call_closure
                                            (|
                                              (M.get_associated_function
                                                (|
                                                  (Ty.path "core::fmt::rt::Argument"),
                                                  "new_display",
                                                  [ Ty.path "u32" ]
                                                |)),
                                              [
                                                M.alloc
                                                  (|
                                                    (BinOp.Panic.add
                                                      (|
                                                        (Value.Integer Integer.U32 1),
                                                        (Value.Integer Integer.U32 2)
                                                      |))
                                                  |)
                                              ]
                                            |)
                                        ])
                                    |))
                            ]
                          |)
                      ]
                    |))
                |) in
            M.alloc (| (Value.Tuple []) |) in
          let _ :=
            let _ :=
              M.alloc
                (|
                  (M.call_closure
                    (|
                      (M.get_function (| "std::io::stdio::_print", [] |)),
                      [
                        M.call_closure
                          (|
                            (M.get_associated_function
                              (| (Ty.path "core::fmt::Arguments"), "new_v1", []
                              |)),
                            [
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.read (| (mk_str "1 - 2 = ") |);
                                          M.read (| (mk_str "
") |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.call_closure
                                            (|
                                              (M.get_associated_function
                                                (|
                                                  (Ty.path "core::fmt::rt::Argument"),
                                                  "new_display",
                                                  [ Ty.path "i32" ]
                                                |)),
                                              [
                                                M.alloc
                                                  (|
                                                    (BinOp.Panic.sub
                                                      (|
                                                        (Value.Integer Integer.I32 1),
                                                        (Value.Integer Integer.I32 2)
                                                      |))
                                                  |)
                                              ]
                                            |)
                                        ])
                                    |))
                            ]
                          |)
                      ]
                    |))
                |) in
            M.alloc (| (Value.Tuple []) |) in
          let _ :=
            let _ :=
              M.alloc
                (|
                  (M.call_closure
                    (|
                      (M.get_function (| "std::io::stdio::_print", [] |)),
                      [
                        M.call_closure
                          (|
                            (M.get_associated_function
                              (| (Ty.path "core::fmt::Arguments"), "new_v1", []
                              |)),
                            [
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.read (| (mk_str "true AND false is ") |);
                                          M.read (| (mk_str "
") |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.call_closure
                                            (|
                                              (M.get_associated_function
                                                (|
                                                  (Ty.path "core::fmt::rt::Argument"),
                                                  "new_display",
                                                  [ Ty.path "bool" ]
                                                |)),
                                              [
                                                M.alloc
                                                  (|
                                                    (LogicalOp.and
                                                      (|
                                                        (Value.Bool true),
                                                        ltac:(M.monadic (Value.Bool false))
                                                      |))
                                                  |)
                                              ]
                                            |)
                                        ])
                                    |))
                            ]
                          |)
                      ]
                    |))
                |) in
            M.alloc (| (Value.Tuple []) |) in
          let _ :=
            let _ :=
              M.alloc
                (|
                  (M.call_closure
                    (|
                      (M.get_function (| "std::io::stdio::_print", [] |)),
                      [
                        M.call_closure
                          (|
                            (M.get_associated_function
                              (| (Ty.path "core::fmt::Arguments"), "new_v1", []
                              |)),
                            [
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.read (| (mk_str "true OR false is ") |);
                                          M.read (| (mk_str "
") |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.call_closure
                                            (|
                                              (M.get_associated_function
                                                (|
                                                  (Ty.path "core::fmt::rt::Argument"),
                                                  "new_display",
                                                  [ Ty.path "bool" ]
                                                |)),
                                              [
                                                M.alloc
                                                  (|
                                                    (LogicalOp.or
                                                      (|
                                                        (Value.Bool true),
                                                        ltac:(M.monadic (Value.Bool false))
                                                      |))
                                                  |)
                                              ]
                                            |)
                                        ])
                                    |))
                            ]
                          |)
                      ]
                    |))
                |) in
            M.alloc (| (Value.Tuple []) |) in
          let _ :=
            let _ :=
              M.alloc
                (|
                  (M.call_closure
                    (|
                      (M.get_function (| "std::io::stdio::_print", [] |)),
                      [
                        M.call_closure
                          (|
                            (M.get_associated_function
                              (| (Ty.path "core::fmt::Arguments"), "new_v1", []
                              |)),
                            [
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.read (| (mk_str "NOT true is ") |);
                                          M.read (| (mk_str "
") |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.call_closure
                                            (|
                                              (M.get_associated_function
                                                (|
                                                  (Ty.path "core::fmt::rt::Argument"),
                                                  "new_display",
                                                  [ Ty.path "bool" ]
                                                |)),
                                              [ M.alloc (| (UnOp.Pure.not (Value.Bool true)) |) ]
                                            |)
                                        ])
                                    |))
                            ]
                          |)
                      ]
                    |))
                |) in
            M.alloc (| (Value.Tuple []) |) in
          let _ :=
            let _ :=
              M.alloc
                (|
                  (M.call_closure
                    (|
                      (M.get_function (| "std::io::stdio::_print", [] |)),
                      [
                        M.call_closure
                          (|
                            (M.get_associated_function
                              (| (Ty.path "core::fmt::Arguments"), "new_v1_formatted", []
                              |)),
                            [
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.read (| (mk_str "0011 AND 0101 is ") |);
                                          M.read (| (mk_str "
") |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.call_closure
                                            (|
                                              (M.get_associated_function
                                                (|
                                                  (Ty.path "core::fmt::rt::Argument"),
                                                  "new_binary",
                                                  [ Ty.path "u32" ]
                                                |)),
                                              [
                                                M.alloc
                                                  (|
                                                    (BinOp.Pure.bit_and
                                                      (Value.Integer Integer.U32 3)
                                                      (Value.Integer Integer.U32 5))
                                                  |)
                                              ]
                                            |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.call_closure
                                            (|
                                              (M.get_associated_function
                                                (| (Ty.path "core::fmt::rt::Placeholder"), "new", []
                                                |)),
                                              [
                                                Value.Integer Integer.Usize 0;
                                                Value.UnicodeChar 32;
                                                Value.StructTuple
                                                  "core::fmt::rt::Alignment::Unknown"
                                                  [];
                                                Value.Integer Integer.U32 8;
                                                Value.StructTuple
                                                  "core::fmt::rt::Count::Implied"
                                                  [];
                                                Value.StructTuple
                                                  "core::fmt::rt::Count::Is"
                                                  [ Value.Integer Integer.Usize 4 ]
                                              ]
                                            |)
                                        ])
                                    |));
                              M.call_closure
                                (|
                                  (M.get_associated_function
                                    (| (Ty.path "core::fmt::rt::UnsafeArg"), "new", []
                                    |)),
                                  []
                                |)
                            ]
                          |)
                      ]
                    |))
                |) in
            M.alloc (| (Value.Tuple []) |) in
          let _ :=
            let _ :=
              M.alloc
                (|
                  (M.call_closure
                    (|
                      (M.get_function (| "std::io::stdio::_print", [] |)),
                      [
                        M.call_closure
                          (|
                            (M.get_associated_function
                              (| (Ty.path "core::fmt::Arguments"), "new_v1_formatted", []
                              |)),
                            [
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.read (| (mk_str "0011 OR 0101 is ") |);
                                          M.read (| (mk_str "
") |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.call_closure
                                            (|
                                              (M.get_associated_function
                                                (|
                                                  (Ty.path "core::fmt::rt::Argument"),
                                                  "new_binary",
                                                  [ Ty.path "u32" ]
                                                |)),
                                              [
                                                M.alloc
                                                  (|
                                                    (BinOp.Pure.bit_or
                                                      (Value.Integer Integer.U32 3)
                                                      (Value.Integer Integer.U32 5))
                                                  |)
                                              ]
                                            |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.call_closure
                                            (|
                                              (M.get_associated_function
                                                (| (Ty.path "core::fmt::rt::Placeholder"), "new", []
                                                |)),
                                              [
                                                Value.Integer Integer.Usize 0;
                                                Value.UnicodeChar 32;
                                                Value.StructTuple
                                                  "core::fmt::rt::Alignment::Unknown"
                                                  [];
                                                Value.Integer Integer.U32 8;
                                                Value.StructTuple
                                                  "core::fmt::rt::Count::Implied"
                                                  [];
                                                Value.StructTuple
                                                  "core::fmt::rt::Count::Is"
                                                  [ Value.Integer Integer.Usize 4 ]
                                              ]
                                            |)
                                        ])
                                    |));
                              M.call_closure
                                (|
                                  (M.get_associated_function
                                    (| (Ty.path "core::fmt::rt::UnsafeArg"), "new", []
                                    |)),
                                  []
                                |)
                            ]
                          |)
                      ]
                    |))
                |) in
            M.alloc (| (Value.Tuple []) |) in
          let _ :=
            let _ :=
              M.alloc
                (|
                  (M.call_closure
                    (|
                      (M.get_function (| "std::io::stdio::_print", [] |)),
                      [
                        M.call_closure
                          (|
                            (M.get_associated_function
                              (| (Ty.path "core::fmt::Arguments"), "new_v1_formatted", []
                              |)),
                            [
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.read (| (mk_str "0011 XOR 0101 is ") |);
                                          M.read (| (mk_str "
") |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.call_closure
                                            (|
                                              (M.get_associated_function
                                                (|
                                                  (Ty.path "core::fmt::rt::Argument"),
                                                  "new_binary",
                                                  [ Ty.path "u32" ]
                                                |)),
                                              [
                                                M.alloc
                                                  (|
                                                    (BinOp.Pure.bit_xor
                                                      (Value.Integer Integer.U32 3)
                                                      (Value.Integer Integer.U32 5))
                                                  |)
                                              ]
                                            |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.call_closure
                                            (|
                                              (M.get_associated_function
                                                (| (Ty.path "core::fmt::rt::Placeholder"), "new", []
                                                |)),
                                              [
                                                Value.Integer Integer.Usize 0;
                                                Value.UnicodeChar 32;
                                                Value.StructTuple
                                                  "core::fmt::rt::Alignment::Unknown"
                                                  [];
                                                Value.Integer Integer.U32 8;
                                                Value.StructTuple
                                                  "core::fmt::rt::Count::Implied"
                                                  [];
                                                Value.StructTuple
                                                  "core::fmt::rt::Count::Is"
                                                  [ Value.Integer Integer.Usize 4 ]
                                              ]
                                            |)
                                        ])
                                    |));
                              M.call_closure
                                (|
                                  (M.get_associated_function
                                    (| (Ty.path "core::fmt::rt::UnsafeArg"), "new", []
                                    |)),
                                  []
                                |)
                            ]
                          |)
                      ]
                    |))
                |) in
            M.alloc (| (Value.Tuple []) |) in
          let _ :=
            let _ :=
              M.alloc
                (|
                  (M.call_closure
                    (|
                      (M.get_function (| "std::io::stdio::_print", [] |)),
                      [
                        M.call_closure
                          (|
                            (M.get_associated_function
                              (| (Ty.path "core::fmt::Arguments"), "new_v1", []
                              |)),
                            [
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.read (| (mk_str "1 << 5 is ") |);
                                          M.read (| (mk_str "
") |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.call_closure
                                            (|
                                              (M.get_associated_function
                                                (|
                                                  (Ty.path "core::fmt::rt::Argument"),
                                                  "new_display",
                                                  [ Ty.path "u32" ]
                                                |)),
                                              [
                                                M.alloc
                                                  (|
                                                    (BinOp.Panic.shl
                                                      (|
                                                        (Value.Integer Integer.U32 1),
                                                        (Value.Integer Integer.I32 5)
                                                      |))
                                                  |)
                                              ]
                                            |)
                                        ])
                                    |))
                            ]
                          |)
                      ]
                    |))
                |) in
            M.alloc (| (Value.Tuple []) |) in
          let _ :=
            let _ :=
              M.alloc
                (|
                  (M.call_closure
                    (|
                      (M.get_function (| "std::io::stdio::_print", [] |)),
                      [
                        M.call_closure
                          (|
                            (M.get_associated_function
                              (| (Ty.path "core::fmt::Arguments"), "new_v1", []
                              |)),
                            [
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.read (| (mk_str "0x80 >> 2 is 0x") |);
                                          M.read (| (mk_str "
") |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [
                                          M.call_closure
                                            (|
                                              (M.get_associated_function
                                                (|
                                                  (Ty.path "core::fmt::rt::Argument"),
                                                  "new_lower_hex",
                                                  [ Ty.path "u32" ]
                                                |)),
                                              [
                                                M.alloc
                                                  (|
                                                    (BinOp.Panic.shr
                                                      (|
                                                        (Value.Integer Integer.U32 128),
                                                        (Value.Integer Integer.I32 2)
                                                      |))
                                                  |)
                                              ]
                                            |)
                                        ])
                                    |))
                            ]
                          |)
                      ]
                    |))
                |) in
            M.alloc (| (Value.Tuple []) |) in
          let _ :=
            let _ :=
              M.alloc
                (|
                  (M.call_closure
                    (|
                      (M.get_function (| "std::io::stdio::_print", [] |)),
                      [
                        M.call_closure
                          (|
                            (M.get_associated_function
                              (| (Ty.path "core::fmt::Arguments"), "new_v1", []
                              |)),
                            [
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (Value.Array
                                        [ M.read (| (mk_str "One million is written as 1000000
") |)
                                        ])
                                    |));
                              (* Unsize *)
                                M.pointer_coercion
                                  (M.alloc
                                    (|
                                      (M.call_closure
                                        (|
                                          (M.get_associated_function
                                            (| (Ty.path "core::fmt::rt::Argument"), "none", []
                                            |)),
                                          []
                                        |))
                                    |))
                            ]
                          |)
                      ]
                    |))
                |) in
            M.alloc (| (Value.Tuple []) |) in
          M.alloc (| (Value.Tuple []) |))
        |)))
  | _, _ => M.impossible
  end.
