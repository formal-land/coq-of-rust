(* Generated by coq-of-rust *)
Require Import CoqOfRust.CoqOfRust.
Require Import CoqOfRust.links.M.

Require Import pinocchio.links.program_error.
Require Import pinocchio.links.pubkey.
Require Import pinocchio.syscalls.   
Require Import pinocchio.sysvars.mod.    
Require Import core.links.result.

Module sysvars.

(*
pub trait Sysvar: Default + Sized {
    fn get() -> Result<Self, ProgramError> { ... }
}
*)
Module Sysvar.
  Definition trait (Self : Set) `{Link Self} : TraitMethod.Header.t :=
    ("pinocchio::sysvars::Sysvar", [], [], Φ Self).

  (* Associated fn: get() -> Result<Self, ProgramError> *)
  Definition Run_get (Self : Set) `{Link Self} : Set :=
    TraitMethod.C (trait Self) "get" (fun method =>
      Run.Trait method [] [] [] (Result.t Self ProgramError.t)
    ).

  Class Run (Self : Set) `{Link Self} : Set := {
    get : Run_get Self;
  }.
End Sysvar.
(*
pub unsafe fn get_sysvar_unchecked(
    dst: *mut u8,
    sysvar_id: &Pubkey,
    offset: usize,
    len: usize,
) -> Result<(), ProgramError>
*)
Instance run_get_sysvar_unchecked
  (dst : Ref.t Pointer.Kind.Raw U8.t)
  (sysvar_id : Ref.t Pointer.Kind.Ref Pubkey.t)
  (offset : Usize.t)
  (len : Usize.t) :
  Run.Trait
   pinocchio.sysvars.mod.sysvars.get_sysvar_unchecked
    [] []
    [ φ dst; φ sysvar_id; φ offset; φ len ]
    (Result.t unit ProgramError.t).
Proof.
  constructor.
  run_symbolic.
  - admit.
  - admit.
  - admit.
Admitted.

(*
pub fn get_sysvar(dst: &mut [u8], sysvar_id: &Pubkey, offset: usize)
    -> Result<(), ProgramError>
*)
Instance run_get_sysvar
  (N : Usize.t)
  (dst : Ref.t Pointer.Kind.Ref (array.t U8.t N))
  (sysvar_id : Ref.t Pointer.Kind.Ref Pubkey.t)
  (offset : Usize.t) :
  Run.Trait
  pinocchio.sysvars.mod.sysvars.get_sysvar
    [] []
    [ φ dst; φ sysvar_id; φ offset ]
    (Result.t unit ProgramError.t).
Proof.
  constructor.
  run_symbolic.
  - admit.
  - admit.
  - admit.
Admitted.

End sysvars.
