(* Generated by coq-of-rust *)
Require Import CoqOfRust.CoqOfRust.

Module extension.
  Module Impl_p3_field_extension_BinomiallyExtendable_Usize_2_for_p3_goldilocks_goldilocks_Goldilocks.
    Definition Self : Ty.t := Ty.path "p3_goldilocks::goldilocks::Goldilocks".
    
    (*     const W: Self = Self::new(7); *)
    (* Ty.path "p3_goldilocks::goldilocks::Goldilocks" *)
    Definition value_W (ε : list Value.t) (τ : list Ty.t) (α : list Value.t) : M :=
      ltac:(M.monadic
        (M.alloc (|
          M.call_closure (|
            Ty.path "p3_goldilocks::goldilocks::Goldilocks",
            M.get_associated_function (|
              Ty.path "p3_goldilocks::goldilocks::Goldilocks",
              "new",
              [],
              []
            |),
            [ Value.Integer IntegerKind.U64 7 ]
          |)
        |))).
    
    (*     const DTH_ROOT: Self = Self::new(18446744069414584320); *)
    (* Ty.path "p3_goldilocks::goldilocks::Goldilocks" *)
    Definition value_DTH_ROOT (ε : list Value.t) (τ : list Ty.t) (α : list Value.t) : M :=
      ltac:(M.monadic
        (M.alloc (|
          M.call_closure (|
            Ty.path "p3_goldilocks::goldilocks::Goldilocks",
            M.get_associated_function (|
              Ty.path "p3_goldilocks::goldilocks::Goldilocks",
              "new",
              [],
              []
            |),
            [ Value.Integer IntegerKind.U64 18446744069414584320 ]
          |)
        |))).
    
    (*
        const EXT_GENERATOR: [Self; 2] = [
            Self::new(18081566051660590251),
            Self::new(16121475356294670766),
        ];
    *)
    (* Ty.apply
      (Ty.path "array")
      [ Value.Integer IntegerKind.Usize 2 ]
      [ Ty.path "p3_goldilocks::goldilocks::Goldilocks" ] *)
    Definition value_EXT_GENERATOR (ε : list Value.t) (τ : list Ty.t) (α : list Value.t) : M :=
      ltac:(M.monadic
        (M.alloc (|
          Value.Array
            [
              M.call_closure (|
                Ty.path "p3_goldilocks::goldilocks::Goldilocks",
                M.get_associated_function (|
                  Ty.path "p3_goldilocks::goldilocks::Goldilocks",
                  "new",
                  [],
                  []
                |),
                [ Value.Integer IntegerKind.U64 18081566051660590251 ]
              |);
              M.call_closure (|
                Ty.path "p3_goldilocks::goldilocks::Goldilocks",
                M.get_associated_function (|
                  Ty.path "p3_goldilocks::goldilocks::Goldilocks",
                  "new",
                  [],
                  []
                |),
                [ Value.Integer IntegerKind.U64 16121475356294670766 ]
              |)
            ]
        |))).
    
    Axiom Implements :
      M.IsTraitInstance
        "p3_field::extension::BinomiallyExtendable"
        (* Trait polymorphic consts *) [ Value.Integer IntegerKind.Usize 2 ]
        (* Trait polymorphic types *) []
        Self
        (* Instance *)
        [
          ("value_W", InstanceField.Method value_W);
          ("value_DTH_ROOT", InstanceField.Method value_DTH_ROOT);
          ("value_EXT_GENERATOR", InstanceField.Method value_EXT_GENERATOR)
        ].
  End Impl_p3_field_extension_BinomiallyExtendable_Usize_2_for_p3_goldilocks_goldilocks_Goldilocks.
  
  Module Impl_p3_field_extension_HasTwoAdicBinomialExtension_Usize_2_for_p3_goldilocks_goldilocks_Goldilocks.
    Definition Self : Ty.t := Ty.path "p3_goldilocks::goldilocks::Goldilocks".
    
    (*     const EXT_TWO_ADICITY: usize = 33; *)
    (* Ty.path "usize" *)
    Definition value_EXT_TWO_ADICITY (ε : list Value.t) (τ : list Ty.t) (α : list Value.t) : M :=
      ltac:(M.monadic (M.alloc (| Value.Integer IntegerKind.Usize 33 |))).
    
    (*
        fn ext_two_adic_generator(bits: usize) -> [Self; 2] {
            assert!(bits <= 33);
    
            if bits == 33 {
                [Self::ZERO, Self::new(15659105665374529263)]
            } else {
                [Self::two_adic_generator(bits), Self::ZERO]
            }
        }
    *)
    Definition ext_two_adic_generator (ε : list Value.t) (τ : list Ty.t) (α : list Value.t) : M :=
      match ε, τ, α with
      | [], [], [ bits ] =>
        ltac:(M.monadic
          (let bits := M.alloc (| bits |) in
          M.read (|
            let~ _ : Ty.apply (Ty.path "*") [] [ Ty.tuple [] ] :=
              M.match_operator (|
                Ty.apply (Ty.path "*") [] [ Ty.tuple [] ],
                M.alloc (| Value.Tuple [] |),
                [
                  fun γ =>
                    ltac:(M.monadic
                      (let γ :=
                        M.use
                          (M.alloc (|
                            UnOp.not (|
                              M.call_closure (|
                                Ty.path "bool",
                                BinOp.le,
                                [ M.read (| bits |); Value.Integer IntegerKind.Usize 33 ]
                              |)
                            |)
                          |)) in
                      let _ := is_constant_or_break_match (| M.read (| γ |), Value.Bool true |) in
                      M.alloc (|
                        M.never_to_any (|
                          M.call_closure (|
                            Ty.path "never",
                            M.get_function (| "core::panicking::panic", [], [] |),
                            [ mk_str (| "assertion failed: bits <= 33" |) ]
                          |)
                        |)
                      |)));
                  fun γ => ltac:(M.monadic (M.alloc (| Value.Tuple [] |)))
                ]
              |) in
            M.match_operator (|
              Ty.apply
                (Ty.path "*")
                []
                [
                  Ty.apply
                    (Ty.path "array")
                    [ Value.Integer IntegerKind.Usize 2 ]
                    [ Ty.path "p3_goldilocks::goldilocks::Goldilocks" ]
                ],
              M.alloc (| Value.Tuple [] |),
              [
                fun γ =>
                  ltac:(M.monadic
                    (let γ :=
                      M.use
                        (M.alloc (|
                          M.call_closure (|
                            Ty.path "bool",
                            BinOp.eq,
                            [ M.read (| bits |); Value.Integer IntegerKind.Usize 33 ]
                          |)
                        |)) in
                    let _ := is_constant_or_break_match (| M.read (| γ |), Value.Bool true |) in
                    M.alloc (|
                      Value.Array
                        [
                          M.read (|
                            get_constant (|
                              "p3_field::field::PrimeCharacteristicRing::ZERO",
                              Ty.path "p3_goldilocks::goldilocks::Goldilocks"
                            |)
                          |);
                          M.call_closure (|
                            Ty.path "p3_goldilocks::goldilocks::Goldilocks",
                            M.get_associated_function (|
                              Ty.path "p3_goldilocks::goldilocks::Goldilocks",
                              "new",
                              [],
                              []
                            |),
                            [ Value.Integer IntegerKind.U64 15659105665374529263 ]
                          |)
                        ]
                    |)));
                fun γ =>
                  ltac:(M.monadic
                    (M.alloc (|
                      Value.Array
                        [
                          M.call_closure (|
                            Ty.path "p3_goldilocks::goldilocks::Goldilocks",
                            M.get_trait_method (|
                              "p3_field::field::TwoAdicField",
                              Ty.path "p3_goldilocks::goldilocks::Goldilocks",
                              [],
                              [],
                              "two_adic_generator",
                              [],
                              []
                            |),
                            [ M.read (| bits |) ]
                          |);
                          M.read (|
                            get_constant (|
                              "p3_field::field::PrimeCharacteristicRing::ZERO",
                              Ty.path "p3_goldilocks::goldilocks::Goldilocks"
                            |)
                          |)
                        ]
                    |)))
              ]
            |)
          |)))
      | _, _, _ => M.impossible "wrong number of arguments"
      end.
    
    Axiom Implements :
      M.IsTraitInstance
        "p3_field::extension::HasTwoAdicBinomialExtension"
        (* Trait polymorphic consts *) [ Value.Integer IntegerKind.Usize 2 ]
        (* Trait polymorphic types *) []
        Self
        (* Instance *)
        [
          ("value_EXT_TWO_ADICITY", InstanceField.Method value_EXT_TWO_ADICITY);
          ("ext_two_adic_generator", InstanceField.Method ext_two_adic_generator)
        ].
  End Impl_p3_field_extension_HasTwoAdicBinomialExtension_Usize_2_for_p3_goldilocks_goldilocks_Goldilocks.
  
  Module Impl_p3_field_extension_BinomiallyExtendable_Usize_5_for_p3_goldilocks_goldilocks_Goldilocks.
    Definition Self : Ty.t := Ty.path "p3_goldilocks::goldilocks::Goldilocks".
    
    (*     const W: Self = Self::new(3); *)
    (* Ty.path "p3_goldilocks::goldilocks::Goldilocks" *)
    Definition value_W (ε : list Value.t) (τ : list Ty.t) (α : list Value.t) : M :=
      ltac:(M.monadic
        (M.alloc (|
          M.call_closure (|
            Ty.path "p3_goldilocks::goldilocks::Goldilocks",
            M.get_associated_function (|
              Ty.path "p3_goldilocks::goldilocks::Goldilocks",
              "new",
              [],
              []
            |),
            [ Value.Integer IntegerKind.U64 3 ]
          |)
        |))).
    
    (*     const DTH_ROOT: Self = Self::new(1041288259238279555); *)
    (* Ty.path "p3_goldilocks::goldilocks::Goldilocks" *)
    Definition value_DTH_ROOT (ε : list Value.t) (τ : list Ty.t) (α : list Value.t) : M :=
      ltac:(M.monadic
        (M.alloc (|
          M.call_closure (|
            Ty.path "p3_goldilocks::goldilocks::Goldilocks",
            M.get_associated_function (|
              Ty.path "p3_goldilocks::goldilocks::Goldilocks",
              "new",
              [],
              []
            |),
            [ Value.Integer IntegerKind.U64 1041288259238279555 ]
          |)
        |))).
    
    (*     const EXT_GENERATOR: [Self; 5] = [Self::TWO, Self::ONE, Self::ZERO, Self::ZERO, Self::ZERO]; *)
    (* Ty.apply
      (Ty.path "array")
      [ Value.Integer IntegerKind.Usize 5 ]
      [ Ty.path "p3_goldilocks::goldilocks::Goldilocks" ] *)
    Definition value_EXT_GENERATOR (ε : list Value.t) (τ : list Ty.t) (α : list Value.t) : M :=
      ltac:(M.monadic
        (M.alloc (|
          Value.Array
            [
              M.read (|
                get_constant (|
                  "p3_field::field::PrimeCharacteristicRing::TWO",
                  Ty.path "p3_goldilocks::goldilocks::Goldilocks"
                |)
              |);
              M.read (|
                get_constant (|
                  "p3_field::field::PrimeCharacteristicRing::ONE",
                  Ty.path "p3_goldilocks::goldilocks::Goldilocks"
                |)
              |);
              M.read (|
                get_constant (|
                  "p3_field::field::PrimeCharacteristicRing::ZERO",
                  Ty.path "p3_goldilocks::goldilocks::Goldilocks"
                |)
              |);
              M.read (|
                get_constant (|
                  "p3_field::field::PrimeCharacteristicRing::ZERO",
                  Ty.path "p3_goldilocks::goldilocks::Goldilocks"
                |)
              |);
              M.read (|
                get_constant (|
                  "p3_field::field::PrimeCharacteristicRing::ZERO",
                  Ty.path "p3_goldilocks::goldilocks::Goldilocks"
                |)
              |)
            ]
        |))).
    
    Axiom Implements :
      M.IsTraitInstance
        "p3_field::extension::BinomiallyExtendable"
        (* Trait polymorphic consts *) [ Value.Integer IntegerKind.Usize 5 ]
        (* Trait polymorphic types *) []
        Self
        (* Instance *)
        [
          ("value_W", InstanceField.Method value_W);
          ("value_DTH_ROOT", InstanceField.Method value_DTH_ROOT);
          ("value_EXT_GENERATOR", InstanceField.Method value_EXT_GENERATOR)
        ].
  End Impl_p3_field_extension_BinomiallyExtendable_Usize_5_for_p3_goldilocks_goldilocks_Goldilocks.
  
  Module Impl_p3_field_extension_HasTwoAdicBinomialExtension_Usize_5_for_p3_goldilocks_goldilocks_Goldilocks.
    Definition Self : Ty.t := Ty.path "p3_goldilocks::goldilocks::Goldilocks".
    
    (*     const EXT_TWO_ADICITY: usize = 32; *)
    (* Ty.path "usize" *)
    Definition value_EXT_TWO_ADICITY (ε : list Value.t) (τ : list Ty.t) (α : list Value.t) : M :=
      ltac:(M.monadic (M.alloc (| Value.Integer IntegerKind.Usize 32 |))).
    
    (*
        fn ext_two_adic_generator(bits: usize) -> [Self; 5] {
            assert!(bits <= 32);
    
            field_to_array(Self::two_adic_generator(bits))
        }
    *)
    Definition ext_two_adic_generator (ε : list Value.t) (τ : list Ty.t) (α : list Value.t) : M :=
      match ε, τ, α with
      | [], [], [ bits ] =>
        ltac:(M.monadic
          (let bits := M.alloc (| bits |) in
          M.read (|
            let~ _ : Ty.apply (Ty.path "*") [] [ Ty.tuple [] ] :=
              M.match_operator (|
                Ty.apply (Ty.path "*") [] [ Ty.tuple [] ],
                M.alloc (| Value.Tuple [] |),
                [
                  fun γ =>
                    ltac:(M.monadic
                      (let γ :=
                        M.use
                          (M.alloc (|
                            UnOp.not (|
                              M.call_closure (|
                                Ty.path "bool",
                                BinOp.le,
                                [ M.read (| bits |); Value.Integer IntegerKind.Usize 32 ]
                              |)
                            |)
                          |)) in
                      let _ := is_constant_or_break_match (| M.read (| γ |), Value.Bool true |) in
                      M.alloc (|
                        M.never_to_any (|
                          M.call_closure (|
                            Ty.path "never",
                            M.get_function (| "core::panicking::panic", [], [] |),
                            [ mk_str (| "assertion failed: bits <= 32" |) ]
                          |)
                        |)
                      |)));
                  fun γ => ltac:(M.monadic (M.alloc (| Value.Tuple [] |)))
                ]
              |) in
            M.alloc (|
              M.call_closure (|
                Ty.apply
                  (Ty.path "array")
                  [ Value.Integer IntegerKind.Usize 5 ]
                  [ Ty.path "p3_goldilocks::goldilocks::Goldilocks" ],
                M.get_function (|
                  "p3_field::helpers::field_to_array",
                  [ Value.Integer IntegerKind.Usize 5 ],
                  [ Ty.path "p3_goldilocks::goldilocks::Goldilocks" ]
                |),
                [
                  M.call_closure (|
                    Ty.path "p3_goldilocks::goldilocks::Goldilocks",
                    M.get_trait_method (|
                      "p3_field::field::TwoAdicField",
                      Ty.path "p3_goldilocks::goldilocks::Goldilocks",
                      [],
                      [],
                      "two_adic_generator",
                      [],
                      []
                    |),
                    [ M.read (| bits |) ]
                  |)
                ]
              |)
            |)
          |)))
      | _, _, _ => M.impossible "wrong number of arguments"
      end.
    
    Axiom Implements :
      M.IsTraitInstance
        "p3_field::extension::HasTwoAdicBinomialExtension"
        (* Trait polymorphic consts *) [ Value.Integer IntegerKind.Usize 5 ]
        (* Trait polymorphic types *) []
        Self
        (* Instance *)
        [
          ("value_EXT_TWO_ADICITY", InstanceField.Method value_EXT_TWO_ADICITY);
          ("ext_two_adic_generator", InstanceField.Method ext_two_adic_generator)
        ].
  End Impl_p3_field_extension_HasTwoAdicBinomialExtension_Usize_5_for_p3_goldilocks_goldilocks_Goldilocks.
End extension.
