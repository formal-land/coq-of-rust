(* Generated by coq-of-rust *)
Require Import CoqOfRust.CoqOfRust.

Import Root.std.prelude.rust_2015.

Module Foo.
  Record t : Set := {
    x : u32 * u32;
    y : u32;
  }.
  
  Global Instance Get_x : Notation.Dot "x" := {
    Notation.dot '(Build_t x0 _) := x0;
  }.
  Global Instance Get_y : Notation.Dot "y" := {
    Notation.dot '(Build_t _ x1) := x1;
  }.
End Foo.
Definition Foo : Set := Foo.t.

(* #[allow(dead_code)] - function was ignored by the compiler *)
Definition main (_ : unit) : M unit :=
  let foo := {| Foo.x := (1, 2); Foo.y := 3; |} in
  match foo with
  | {| Foo.x := (1, b); Foo.y := y; |} =>
    let* α0 := format_argument::["new_display"] (deref b) in
    let* α1 := format_argument::["new_display"] (deref y) in
    let* α2 :=
      format_arguments::["new_v1"]
        (deref [ "First of x is 1, b = "; ",  y = "; " 
" ])
        (deref [ α0; α1 ]) in
    let* _ := _crate.io._print α2 in
    Pure tt
  | {| Foo.y := 2; Foo.x := i; |} =>
    let* α0 := format_argument::["new_debug"] (deref i) in
    let* α1 :=
      format_arguments::["new_v1"]
        (deref [ "y is 2, i = "; "
" ])
        (deref [ α0 ]) in
    let* _ := _crate.io._print α1 in
    Pure tt
  | {| Foo.y := y; |} =>
    let* α0 := format_argument::["new_display"] (deref y) in
    let* α1 :=
      format_arguments::["new_v1"]
        (deref [ "y = "; ", we don't care about x
" ])
        (deref [ α0 ]) in
    let* _ := _crate.io._print α1 in
    Pure tt
  end.
