(* Generated by coq-of-rust *)
Require Import CoqOfRust.CoqOfRust.

Import Root.std.prelude.rust_2015.

Module Command := std.process.Command.
Definition Command := Command.t.

(* #[allow(dead_code)] - function was ignored by the compiler *)
Definition main (_ : unit) : M unit :=
  let* α0 := Command::["new"] "rustc" in
  let* α1 := α0.["arg"] "--version" in
  let* α2 := α1.["output"] in
  let* output :=
    α2.["unwrap_or_else"]
      (fun e =>
        let* α0 := format_argument::["new_display"] (deref e) in
        let* α1 :=
          format_arguments::["new_v1"]
            (deref [ "failed to execute process: " ])
            (deref [ α0 ]) in
        _crate.rt.panic_fmt α1) in
  let* α3 := output.["status"].["success"] in
  if (α3 : bool) then
    let* s := String::["from_utf8_lossy"] (deref output.["stdout"]) in
    let* α0 := format_argument::["new_display"] (deref s) in
    let* α1 :=
      format_arguments::["new_v1"]
        (deref [ "rustc succeeded and stdout was:
" ])
        (deref [ α0 ]) in
    let* _ := _crate.io._print α1 in
    let _ := tt in
    Pure tt
  else
    let* s := String::["from_utf8_lossy"] (deref output.["stderr"]) in
    let* α0 := format_argument::["new_display"] (deref s) in
    let* α1 :=
      format_arguments::["new_v1"]
        (deref [ "rustc failed and stderr was:
" ])
        (deref [ α0 ]) in
    let* _ := _crate.io._print α1 in
    let _ := tt in
    Pure tt.
